{
  "version": "v1.0",
  "description": "Regras comerciais v1.0 com suporte a itens e operadores customizados",
  "rules": [
    {
      "id": "R_APPLY_DISCOUNT",
      "phase": "baseline",
      "logic": {
        "*": [
          { "var": "order.BaseValue" },
          { "-": [1, { "var": "order.DiscountPercentage" }] }
        ]
      },
      "output_key": "order.BaseValue"
    },
    {
      "id": "R_TAX_VAT",
      "phase": "taxes",
      "logic": { "*": [0.20, { "var": "order.BaseValue" }] },
      "output_key": "order.AppliedTaxes.VAT"
    },
    {
      "id": "R_FINAL_TOTAL",
      "phase": "totals",
      "logic": {
        "+": [
          { "var": "order.BaseValue" },
          { "var": "order.AppliedTaxes.VAT" }
        ]
      },
      "output_key": "order.TotalValue"
    }
  ]
}